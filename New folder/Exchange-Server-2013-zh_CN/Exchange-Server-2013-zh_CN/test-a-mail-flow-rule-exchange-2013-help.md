---
title: '测试邮件流规则: Exchange 2013 Help'
TOCTitle: 测试邮件流规则
ms:assetid: 3d949e2a-8ba4-4261-8cfb-736fd2446ea1
ms:mtpsurl: https://technet.microsoft.com/zh-cn/library/Dn831862(v=EXCHG.150)
ms:contentKeyID: 63145018
ms.date: 01/11/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# 测试邮件流规则

 

_**适用于：** Exchange Online, Exchange Online Protection, Exchange Server 2013_

_**上一次修改主题：** 2016-12-09_

每次创建 Exchange 邮件流规则（也称为传输规则）时，您应先进行测试，然后再将其打开。这样，如果您意外创建了一个条件，无法准确执行您所需的操作或以意外的方式与其他规则进行交互，也不会给您带来任何意外结果。

> [!important]
> 创建规则后等待 30 分钟，然后再对其进行测试。如果您创建规则后立即进行测试，可能会产生不一致的行为。如果您使用 Exchange Server 并且具有多台 Exchange 服务器，可能需要更长时间以便所有服务器接收该规则。


## 步骤 1：在测试模式下创建规则

通过选择测试模式，您可以在不执行影响邮件流的任何操作的情况下，评估规则的条件。您可以设置一个规则，以便在匹配规则时收到电子邮件通知，您也可以查看查看邮件跟踪查找符合该规则的邮件。有两种测试模式：

  - **不使用策略提示测试**   将此模式与事件报告操作一起使用，只要电子邮件匹配规则，您就会收到电子邮件。

  - **使用策略提示测试**   仅当使用[数据丢失预防](technical-overview-of-dlp-data-loss-prevention-in-exchange.md) (DLP)（在某些 Exchange Online 和 Exchange Online Protection (EOP) 订阅计划中可用）时，此模式才可用。使用此模式时，当发件人发送的某封邮件匹配策略时，邮件将发送给发件人，但未执行任何邮件流操作。

下面是匹配规则时将看到的内容（如果包含事件报告操作）：

![检测到规则时发送消息](images/Dn831862.c1a2db60-3fb9-4ddc-86d5-1757e2250f59(EXCHG.150).png "检测到规则时发送消息")

**在测试模式下使用事件报告操作**

1.  在 Exchange 管理中心 (EAC) 中，转到“邮件流”\>“规则”。

2.  创建新规则，或选择现有的规则，然后选择“编辑”。

3.  向下滚动到“为此规则选择模式”部分，然后选择“不使用策略提示测试”或“使用策略提示测试”。

4.  添加事件报告操作：
    
    1.  选择“添加操作”，如果不显示，请选择“更多选项”，然后选择“添加操作”。
    
    2.  选择“生成事件报告并将它发送到”。
    
    3.  单击“选择一个...”，然后选择您自己或其他人。
    
    4.  选择“包括邮件属性”，然后选择您希望包含在收到的电子邮件中的任何邮件属性。如果未选择任何属性，在规则匹配时仍会收到一封电子邮件。

5.  选择“保存”。

## 步骤 2：评估规则是否执行您所希望的操作

要测试规则，您可以发送足够的测试邮件以确认您预期的情况发生，或查看邮件跟踪中是否有您组织的人员发送的邮件。确保评估下列类型的邮件：

  - 您希望与规则匹配的邮件

  - 您不希望与规则匹配的邮件

  - 发送到和发送自您的组织中的用户的邮件

  - 发送到和发送自您的组织外部的用户的邮件

  - 对与规则匹配的邮件的答复

  - 可能会导致多个规则之间交互的邮件

## 发送测试邮件的提示

一种测试方法是以测试邮件的发件人和收件人身份登录。

  - 如果您没有对您的组织中多个帐户的访问权限，您可以使用 [Office 365 试用帐户](https://go.microsoft.com/fwlink/p/?linkid=402791)进行测试，或在您的组织中创建一些临时的假用户。

  - 由于 Web 浏览器通常不允许您在登录到多个帐户的相同计算机上同时打开多个会话，您可以使用 [Internet Explorer InPrivate 浏览](https://go.microsoft.com/fwlink/p/?linkid=402784)，或为每个用户使用不同的计算机、设备或 Web 浏览器。

## 查看邮件跟踪

邮件跟踪包括邮件匹配的的每个规则，以及规则采取的每个操作的条目。这对于跟踪测试邮件会发生什么情况非常有用，还可以跟踪实际邮件在您的组织中传递时会发生什么情况。

![显示传输规则操作的消息跟踪](images/Dn831862.64179f28-5c8c-421b-b630-cc1f7de9a34f(EXCHG.150).png "显示传输规则操作的消息跟踪")

1.  在 EAC 中，转到“邮件流”\>“邮件跟踪”。

2.  查找您要使用发件人和发送日期等条件跟踪的邮件。若要帮助指定条件，请参阅[运行邮件跟踪和查看结果](https://technet.microsoft.com/zh-cn/library/jj200712\(v=exchg.150\))。

3.  找到您想要跟踪的邮件后，请双击该邮件以查看有关邮件的详细信息。

4.  在“事件”列中查找“传输规则”。“操作”列显示执行的特定操作。

## 步骤 3：当您完成测试时，将规则设置为强制实施

1.  在 EAC 中，转到“邮件流”\>“规则”。

2.  选择一个规则，然后选择“编辑”。

3.  选择“强制实施”。

4.  如果您使用某项操作来生成事件报告，请选择操作，然后选择“删除”。

5.  选择“保存”。

> [!tip]
> 为避免意外，请向用户介绍新规则。


## 疑难解答建议

下面是一些常见的问题和解决方法：

  - **一切都看上去正常，但规则不起作用。**
    
    有时可能需要 15 分钟以上的时间，新邮件流才可用。请等待几小时，然后再进行测试。另外，请检查是否另一个规则存在干扰。请尝试将此规则移动到列表顶部，并将其优先级更改为 0。

  - **将免责声明添加到原始邮件和所有答复，而不仅仅是原始邮件。**
    
    为避免此问题，可以向免责声明规则添加一种例外，在免责声明中查找某个唯一短语。

  - **我的规则具有两个条件，我希望在满足任一条件时即执行操作，但它仅在满足两个条件时才执行操作。**
    
    您需要创建两个规则，每个条件一个。您可以通过选择“复制”轻松地复制规则，然后从原始条件和副本中的其他条件删除一个条件。

  - **我正在与多个通讯组合作，但“发件人为 (SentTo)”** **似乎不起作用。**
    
    **SentTo** 匹配其中一个收件人为邮箱、已启用邮件的用户或联系人的邮件，但您不能使用该条件指定通讯组。请转为使用“‘收件人’框包含以下组的成员 (SentToMemberOf)”。

## 其他测试选项

如果您正在使用 Exchange Online 或 Exchange Online Protection，您可以通过使用规则报告来检查每一条规则的匹配次数。为了包含在报告中，必须选中规则的“使用以下严重性级别审核此规则”复选框。这些报告有助于您揭示规则使用情况中的趋势并标识不匹配的规则。

若要查看规则报告，请在Office 365 管理中心中选择**“报告”**。

> [!NOTE]
> 虽然大部分数据会在 24 小时内出现在报告中，但有些数据可能需要长达 5 天才会出现。


![显示规则使用情况的报告](images/Dn831862.df5bf202-741d-432a-b71d-b37143f0ec0a(EXCHG.150).png "显示规则使用情况的报告")

若要了解详细信息，请参阅[查看邮件保护报告](https://go.microsoft.com/fwlink/p/?linkid=402958)。

## 需要更多帮助？

[管理邮件流规则](manage-mail-flow-rules-exchange-2013-help.md)

[Exchange Online 中的邮件流规则（传输规则）](https://technet.microsoft.com/zh-cn/library/jj919238\(v=exchg.150\)) (Exchange Online)

[Exchange Online Protection 中的邮件流规则（传输规则）](https://technet.microsoft.com/zh-cn/library/dn271424\(v=exchg.150\)) (Exchange Online Protection)

[邮件流或传输规则](mail-flow-rules-transport-rules-in-exchange-2013-exchange-2013-help.md) (Exchange Server)

